<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Live Environment Test-Area</title>
    <style>
        body {
            background-color: #F0E68C;
            font-family: "Courier New", Courier, monospace;
            color: #000;
            margin: 0;
        }
        header {
            background-color: #8B4513;
            color: #FFFFFF;
            padding: 20px;
            text-align: center;
        }
        nav {
            background-color: #DEB887;
            padding: 10px;
            text-align: center;
        }
        nav a {
            color: #000000;
            margin: 0 15px;
            text-decoration: none;
            font-weight: bold;
        }
        main {
            padding: 20px;
        }
        h1, h2 {
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        footer {
            background-color: #8B4513;
            color: #FFFFFF;
            padding: 10px;
            text-align: center;
            position: fixed;
            bottom: 0;
            width: 100%;
        }
        .button {
            background-color: #DEB887;
            border: none;
            color: #000000;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            margin: 10px 0;
            cursor: pointer;
            font-family: "Courier New", Courier, monospace;
        }
        .button:hover {
            background-color: #D2B48C;
        }
    </style>
    <!-- Einbinden von Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <h1>Willkommen auf meiner Retro-Webseite</h1>
    </header>
    <nav>
        <a href="./result.png" download>Result Bild Downloaden</a>
        <a href="./history.json" download>Json Historie Downloaden</a>
        <a href="./history.csv" download>CSV Historie Downloaden</a>
    </nav>
    <main>
        <h2>Über die Seite</h2>
        <p>
            Diese Seite ist nur zum Testen der Funktionen und des kurzfristigen
            Environments.
        </p>
        <!-- Platzhalter für das Diagramm -->
        <canvas id="myChart" width="400" height="200"></canvas>
    </main>
    <footer>
        &copy; 2024 Retro-Webseite. Alle Rechte vorbehalten.
    </footer>

    <script>
        // Laden und Verarbeiten der CSV-Datei
        fetch('./history.csv')
        .then(response => response.text())
        .then(data => {
            // CSV-Daten parsen
            var parsedData = parseCSV(data);
            if(parsedData.length < 2) {
                console.error('CSV-Daten sind leer oder fehlerhaft.');
                return;
            }
            // Header-Zeile und Index der 'new_Money' Spalte ermitteln
            var headers = parsedData[0];
            var headerIndex = headers.indexOf('new_Money');
            if(headerIndex === -1) {
                console.error('Spalte "new_Money" nicht in der CSV-Datei gefunden.');
                return;
            }

            // Daten extrahieren
            var labels = [];
            var newMoneyData = [];
            for(var i = 1; i < parsedData.length; i++) {
                var row = parsedData[i];
                if(row.length > headerIndex) {
                    labels.push(i); // Alternativ kannst du hier Zeitstempel verwenden, falls vorhanden
                    newMoneyData.push(parseFloat(row[headerIndex]));
                }
            }

            // Diagramm erstellen
            var ctx = document.getElementById('myChart').getContext('2d');
            var myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'new_Money',
                        data: newMoneyData,
                        backgroundColor: 'rgba(222, 184, 135, 0.2)',
                        borderColor: 'rgba(139, 69, 19, 1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.1,
                        pointRadius: 3
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            display: true,
                            title: {
                                display: true,
                                text: 'Index'
                            }
                        },
                        y: {
                            display: true,
                            title: {
                                display: true,
                                text: 'new_Money'
                            }
                        }
                    }
                }
            });
        })
        .catch(error => {
            console.error('Fehler beim Laden oder Verarbeiten von history.csv:', error);
        });

        // Einfache CSV-Parser-Funktion
        function parseCSV(data) {
            var lines = data.trim().split('\n');
            var result = [];
            lines.forEach(function(line) {
                var values = line.split(',');
                result.push(values);
            });
            return result;
        }
    </script>
</body>
</html>
